"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Observable=function(){var e=this;return e.data,e.subs=[],e.methods={publish:function(t){if(void 0===t)return e.data;e.data=t;for(var l=0,i=e.subs.length;l<i;++l)e.subs[l](e.data)},subscribe:function(t){-1===e.subs.indexOf(t)&&e.subs.push(t)},unsubscribe:function(t){-1!==e.subs.indexOf(t)&&e.subs.splice(e.subs.indexOf(t),1)}},e.methods},view={game_field:document.getElementsByClassName("game")[0],pawns:document.querySelectorAll(".pawns>[id^=pawn-]"),tiles:document.getElementsByClassName("tile")},model={field_size:new Observable,tiles:[],pawns:[],tileLocation:new Observable,tileType:new Observable},GameFieldController={initial:function(){this.fillFieldData(),viewController.setTileAssets()},fillFieldData:function(){model.field_size.publish(parseInt(view.game_field.dataset.field_size));for(var e=0,t=0;t<model.field_size.publish();++t){for(var l=[],i=function(i){var s,o=new Observable;o.publish({x:i,y:t,type:view.tiles[e].dataset.tileType,rotation:parseInt(view.tiles[e].dataset.tileRotation)}),s=e,o.subscribe(function(e){var t=view.tiles[s],l=t.getElementsByTagName("img")[0];l.classList.contains("place-"+e.x+"-"+e.y)||(viewController.clearClass(t,"place"),t.classList.add("place-"+e.x+"-"+e.y)),l.classList.contains("rotate-"+e.rotation)||(viewController.clearClass(l,"rotate"),l.classList.add("rotate-"+e.rotation)),l.src!==model.tileLocation.publish()+e.type+"."+model.tileType.publish()&&(l.src=model.tileLocation.publish()+e.type+"."+model.tileType.publish()),e.x>=model.field_size.publish()+1&&console.warn("the x value("+e.x+") is to large and the tile will appear as floating in the air"),e.y>=model.field_size.publish()+1&&console.warn("the y value("+e.y+") is to large and the tile will appear as floating in the air"),e.x<-1&&console.warn("the x value("+e.x+") is to small and the style will reset to 0"),e.y<-1&&console.warn("the y value("+e.y+") is to small and the style will reset to 0"),0!==e.rotation&&90!==e.rotation&&180!==e.rotation&&270!==e.rotation&&console.warn("the rotation value("+e.rotation+") is not in the range of options and the style will reset to 0"),"corner"!==e.type&&"tpoint"!==e.type&&"line"!==e.type&&(console.log(_typeof(e.type)),console.error("the tile type value("+e.type+") is not in the range of options and it will disappear!"))}),l.push(o),++e},s=0;s<model.field_size.publish();++s)i(s);model.tiles.push(l)}Math.pow(model.field_size.publish(),2)!==view.tiles.length&&console.warn("Warning: amount of tiles("+view.tiles.length+") is not equal to the field_size^2 ("+model.field_size.publish()+"^2 = "+Math.pow(model.field_size.publish(),2)+")")}},viewController={clearClass:function(e,t){var l=e.className.match(new RegExp(t+"[-,0-9]*","g"));l&&e.classList.remove(l[0])},setTileAssets:function(){var e=view.tiles[0].getElementsByTagName("img")[0].src;model.tileLocation.publish(e.match(/.+\//g)[0]),model.tileType.publish(e.match(/(?!\.)([a-z]{3,})$/gm)[0])}};GameFieldController.initial();